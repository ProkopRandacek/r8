# vim: ft=make
# I hate this. Fuck windows. Use Linux. Thank you

# im keeping this cross compile mess away from the rest of the makefiles
# Umka crosscompile can be done by just compiling all the .c files together with the rest of r8
# I don't know how to cross compile raylib or openvr so I have to download the precompiled binary

CROSS_CC = x86_64-w64-mingw32-gcc
CROSS_FLAGS = -lm -lwinmm -Ldl -lopengl32 -lgdi32 -Wl,-Bstatic -lpthread $(WARNS)

UMKA_SRC = $(filter-out umka-lang/src/umka.c,$(wildcard umka-lang/src/*.c))
RAYLIB_SRC = libraylib.a

# https://gist.github.com/gvenzl/1386755861fb42db492276d3864a378c
cross: $(SHDH)
	@curl https://rdck.dev/dl/raylib/libraylib.a -O # raylib 3.7.0
	$(CROSS_CC) -DPLATFORM_DESKTOP -DGRAPHICS_API_OPENGL_33 $(CFLAGS) -o r8.exe $(SRCS) $(UMKA_SRC) $(RAYLIB_SRC) $(CROSS_FLAGS) -s

clean::
	@$(RM) r8.exe libraylib.a
